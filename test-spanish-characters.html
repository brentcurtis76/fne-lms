<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spanish Character Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .highlight-problem {
            background-color: #ffcccc;
            padding: 10px;
            border-left: 4px solid #ff0000;
        }
        .highlight-correct {
            background-color: #ccffcc;
            padding: 10px;
            border-left: 4px solid #00ff00;
        }
        .char-code {
            font-family: monospace;
            background-color: #f0f0f0;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>Spanish Character Encoding Test</h1>
    
    <div class="test-section">
        <h2>1. Font Rendering Test</h2>
        <p><strong>What database has (correct):</strong></p>
        <div class="highlight-correct">¿Cómo desarrollar el plan personal en etapa preescolar?</div>
        
        <p><strong>What user sees (wrong):</strong></p>
        <div class="highlight-problem">¡Cómo desarrollar el plan personal en etapa preescolar?</div>
        
        <p><strong>Character Analysis:</strong></p>
        <ul>
            <li>Correct: <span class="char-code">¿</span> (U+00BF - Inverted Question Mark)</li>
            <li>Wrong: <span class="char-code">¡</span> (U+00A1 - Inverted Exclamation Mark)</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>2. Font Family Tests</h2>
        
        <p><strong>Default font (Arial):</strong><br>
        <span style="font-family: Arial, sans-serif;">¿Cómo desarrollar el plan personal en etapa preescolar?</span></p>
        
        <p><strong>Sans-serif fallback:</strong><br>
        <span style="font-family: sans-serif;">¿Cómo desarrollar el plan personal en etapa preescolar?</span></p>
        
        <p><strong>System font:</strong><br>
        <span style="font-family: -apple-system, BlinkMacSystemFont, sans-serif;">¿Cómo desarrollar el plan personal en etapa preescolar?</span></p>
        
        <p><strong>Inter font (used in FNE LMS):</strong><br>
        <span style="font-family: 'Inter', sans-serif;">¿Cómo desarrollar el plan personal en etapa preescolar?</span></p>
        
        <p><strong>Mont font (FNE LMS font-mont class - likely missing):</strong><br>
        <span style="font-family: 'Mont', sans-serif;">¿Cómo desarrollar el plan personal en etapa preescolar?</span></p>
    </div>

    <div class="test-section">
        <h2>3. API Test</h2>
        <button onclick="testAPI()">Test Course Builder API</button>
        <div id="api-results"></div>
    </div>

    <div class="test-section">
        <h2>4. JavaScript Character Test</h2>
        <button onclick="testCharacters()">Test Character Handling</button>
        <div id="js-results"></div>
    </div>

    <script src="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" onload="console.log('Inter font loaded')"></script>
    
    <script>
        function testAPI() {
            const resultsDiv = document.getElementById('api-results');
            resultsDiv.innerHTML = '<p>Testing API...</p>';
            
            // Test the specific course from the bug report
            const courseId = '26cc436a-5853-4f0f-9e57-8b7e152b4772';
            
            // Try to fetch from localhost (development server)
            fetch(`http://localhost:3000/api/courses/${courseId}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(data => {
                    console.log('API Response:', data);
                    resultsDiv.innerHTML = `
                        <h4>API Response:</h4>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                        <p><strong>Check for Spanish characters in the response above</strong></p>
                    `;
                })
                .catch(error => {
                    console.error('API Error:', error);
                    resultsDiv.innerHTML = `
                        <p style="color: red;"><strong>API Error:</strong> ${error.message}</p>
                        <p>Make sure the development server is running at localhost:3000</p>
                        <p>Try: <code>npm run dev</code></p>
                    `;
                });
        }
        
        function testCharacters() {
            const resultsDiv = document.getElementById('js-results');
            
            // Test strings
            const correct = "¿Cómo desarrollar el plan personal en etapa preescolar?";
            const wrong = "¡Cómo desarrollar el plan personal en etapa preescolar?";
            
            // Character analysis
            const analysis = {
                correctFirst: {
                    char: correct[0],
                    unicode: correct.charCodeAt(0),
                    hex: correct.charCodeAt(0).toString(16).toUpperCase()
                },
                wrongFirst: {
                    char: wrong[0],
                    unicode: wrong.charCodeAt(0),
                    hex: wrong.charCodeAt(0).toString(16).toUpperCase()
                }
            };
            
            console.log('Character Analysis:', analysis);
            
            resultsDiv.innerHTML = `
                <h4>Character Analysis Results:</h4>
                <table border="1" style="border-collapse: collapse; width: 100%;">
                    <tr>
                        <th>Type</th>
                        <th>Character</th>
                        <th>Unicode Value</th>
                        <th>Hex</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>Correct (Database)</td>
                        <td style="font-size: 1.5em;">${analysis.correctFirst.char}</td>
                        <td>U+${analysis.correctFirst.hex.padStart(4, '0')}</td>
                        <td>0x${analysis.correctFirst.hex}</td>
                        <td style="color: green;">✓ Inverted Question Mark</td>
                    </tr>
                    <tr>
                        <td>Wrong (Display)</td>
                        <td style="font-size: 1.5em;">${analysis.wrongFirst.char}</td>
                        <td>U+${analysis.wrongFirst.hex.padStart(4, '0')}</td>
                        <td>0x${analysis.wrongFirst.hex}</td>
                        <td style="color: red;">✗ Inverted Exclamation</td>
                    </tr>
                </table>
                
                <h4>Test Results:</h4>
                <p><strong>String Comparison:</strong></p>
                <p>Are they equal? ${correct === wrong ? 'Yes' : 'No'}</p>
                <p>Length difference: ${Math.abs(correct.length - wrong.length)}</p>
                
                <h4>Browser/Font Test:</h4>
                <p>If the characters above look the same in your browser, the issue is visual (font rendering).</p>
                <p>If they look different, the issue is character-based.</p>
            `;
        }
        
        // Auto-run character test on page load
        window.onload = function() {
            console.log('Spanish Character Test Page Loaded');
            console.log('Database stores: ¿Cómo desarrollar...');
            console.log('User sees: ¡Cómo desarrollar...');
            console.log('Are they visually different in console?');
        };
    </script>
</body>
</html>